<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Portfolio Trade </title>
    <style>

        :root
        {
            --backgroundColor: #2d2d2d;
            --backgroundAccent: #4e4d4d;
            --backgroundDarker: #1b1b1b;
            --purple: #cc23ff;
            --purpleShine: #e283ff;
            --purpleDark: #701b8a;
            --blueDark: #00009c;
            --blueDarker: #020230;
            --skintone: #fe9b9e;
            --skintoneDark: #754648;

        }

        body
        {
            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
            background-color: var(--backgroundColor);
            color: white;
        }


        nav
        {
            width: 100%;
            text-transform: uppercase;
        }

        main
        {
            display: grid; /* Ativa o Grid Layout */
            grid-template-columns: 0.6fr 2fr 1fr;/* Cria 3 colunas, cada uma ocupando 1 fração (1fr) do espaço disponível  para cada section (painel) */
            gap: 10px; 
            width: 100%; 
            margin-top: 15px;
        }

        /*each section  is a panel */

        section
        {
            display: flex;
            flex-direction: column;
            justify-content: start;
            align-items: center;
            border: 0.2px solid var(--backgroundAccent);
            border-radius: 23px;
            padding: 5px;
            min-height: 100vh;
            

        }

        /* each line on the first and third section */

        section div
        {
            margin: 5px 0;
        }


        /*form for all line on the first section, one in the first and two in anothers */
    

        .form__group {
            position: relative;
            padding: 15px 0 0;
            margin-top: 10px;
            width: 100%;
            }

            .form__field {
            width: 100%;
            border: 0;
            border-bottom: 0.2px solid var(--backgroundAccent);
            outline: 0;
            font-size: 1.3rem;
            color: white;
            padding: 7px 0;
            background: transparent;
            transition: border-color 0.2s;
            text-transform: capitalize;

            &::placeholder {
                color: transparent;
            }

            &:placeholder-shown ~ .form__label {
                font-size: 13px; /*placehold before click*/
                cursor: text;
                top: 25px;
            }

            

            
            }

            .form__label {
            position: absolute;
            top: 0;
            display: block;
            transition: 0.2s;
            font-size: 13px;
            color: var(--purple);
            }

            .form__field:focus {
            ~ .form__label {
                position: absolute;
                top: 0;
                display: block;
                transition: 0.2s;
                font-size: 13px; /* placehold after click */
                color: var(--purpleShine);
                font-weight:700;    
            }
            padding-bottom: 6px;  
            font-weight: 700;
            border-width: 3px;
            border-image: linear-gradient(to right, transparent, transparent); /*background of input when clicked*/
            border-image-slice: 1;
            }


            /* reset input */
            .form__field{
            &:required,&:invalid { box-shadow:none; }
            }

            .form__field
            {
                font-size: 10px;
            }


            /* each line of section skiping first*/
            .inline
            {
                display: inline-flex;
                flex-direction: row;
                justify-content: space-around;
                align-items: end;
                margin: 5px;
                width: 100%;
            }

            .inline select
            {
                margin: 0 5px 0 0;
            }

            .form__field.tiny
            {
                width: 90%;
            }

            .inline .form__group.tiny .form__field
            {
                &:placeholder-shown ~ .form__label {
                font-size: 10px; /*placehold before click*/
                cursor: text;
                top: 0px;
                }
            }

            .inline .form__group.tiny .form__field:focus, .inline .form__group.tiny .form__label 
            {
                font-size: 10px;
            }

            select option
            {
                background-color: var(--backgroundColor);
            }

            /* Last line of first section */

            button
            {
                margin: 25px 0;
                background-color: var(--purple);
                color: white;
                font-size: 0.6em;
                font-weight: bold;
                cursor: pointer;
                display: flex;
                align-items: center;
                border-width: initial;
                border-style: none;
                border-color: initial;
                border-image: initial;
                padding: 15px 30px;
                border-radius: 50px;
                gap: 8px;
                transition: background-color 0.2s;
            }

            button:hover
            {
                background-color: var(--purpleShine);
            }


            /*CALENDAR PART */


            /*caledar open/hide button */

            #calendarSwitch
            {
                padding: 4px 15px;
                width: 100%;
                display: flex;
                text-align: center;
                justify-content: center;
                margin: 0;
                margin-bottom: 10px;
                

            }

            /*calendar container: Where is the button to open calendar and the calendar */

            .calendar_container
            {
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                color: var(--purple);
                
                
            }

            /*real caledar style */

            
            
            .calendar {
            width: 350px;
            background-color: var(--backgroundDarker);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            display: none;
            }



            .calendar.show
            {
                z-index: 2;
                display: block;
                position: absolute;
                animation-name: slideDownFadeIn; 
                animation-duration: 0.8s;        
                animation-timing-function: ease-out; 
                animation-fill-mode: forwards;   
                
                /* Estado inicial (importante para que ele comece invisível) */
                opacity: 0;
                
            }

           

            @keyframes slideDownFadeIn {
                /* 0% (Início da animação) */
                from {
                    opacity: 0;
                    /* Move o elemento para 30px acima de sua posição final */
                    transform: translateY(30px); 
                }

                /* 100% (Fim da animação) */
                to {
                    opacity: 1;
                    /* Retorna o elemento para sua posição original */
                    transform: translateY(130px);
                }
            }

            .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            }
            .calendar-header button {
            background-color: transparent;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            }
            #month-year {
            font-size: 1.2em;
            font-weight: bold;
            }
            .calendar-weekdays, .calendar-dates {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            }
            .calendar-weekdays div, .calendar-dates div {
            text-align: center;
            padding: 10px;
            }
            .calendar-weekdays {
            background-color: #eaeef3;
            }
            .calendar-weekdays div {
            font-weight: bold;
            }
            .calendar-dates div {
            cursor: pointer;
            }
            .calendar-dates div:hover {
            background-color: #f1f1f1;
            }

            /* day that already gone */

            .calendar-dates .unable
            {
                color: var(--backgroundAccent);
                font-style: italic;
            }


            /* Selected date div */

            .selectDay
            {
                background-color: var(--backgroundAccent);
                border-radius: 10px;
                border-width: 0;
            }

            /*END CALENDAR PART */


            /*START PIZZA GRAFIC PART */

            .all_pizza_container
            {
                display: grid;
                grid-template-columns: 1fr 1fr;
                width: 100%;
                align-items: center;


            }

            .pizza_container
            {
                padding: 15px;
                border: none;
                margin: 0;
                min-height: 500px;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
                align-items: center;
                border-bottom: 0.2px solid var(--backgroundAccent);

            }

            /*  Border to see the division in elements   */
            .pizza_container:nth-child(odd)
            {
                border-right: 0.2px solid var(--backgroundAccent);
            }

            /*take out the border of last two elements */

            .pizza_container:nth-last-child(-n + 2)
            {
                border-bottom: none;
            }

            .all_pizza_container label
            {
                padding: 5px 0;
                font-size: 13px;
                color: var(--purple);

            }


            .pizzaChart
            {
                width: 100%;
                height: auto;
                margin: 8px;
            }




            /*END PIZZA GRAFIC PART*/


            /*THIRD PANEL PART */
            #thirdPanel
            {
                color: var(--purple);
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: start;
            }

            #thirdPanel div
            {
                width: 95%;
            }


            #thirdPanel .center, #thirdPanel .investiment_characteristics.title
            {
                display: flex;
                text-align: center;
                flex-direction: column;
               

                
            }

            #thirdPanel .center
            {
                border-bottom: 0.2px solid var(--backgroundAccent);
                width: 100%;
                margin: 0; padding: 0;

            }

            /*
            
            .investiment => container of each investment
            .investment_
            
            */
            
            #thirdPanel .investiment
            {
                padding: 5px;
                border: none;
                border-bottom: 0.2px solid var(--backgroundAccent);
                width: 100%;
            }

            #thirdPanel .investiment div
            {
                width: 95%;
            }

           




            


            #thirdPanel span
            {
                font-size: 12px;
                margin: 0;
                padding: 0;
            }

            #thirdPanel p
            {
                color: var(--backgroundAccent);
                margin: 0; padding: 0;
            }


            /* show % of each forecast */

            .investiment_characteristics:last-child
            {
                display: flex;
                flex-direction: column;
                justify-content: center;
            }

            .investiment_characteristics:last-child span
            {
                text-align: center;
            }


            .investiment_characteristics .rate
            {
                width: 100%;
                margin: 0 5px;
                display: grid;
                grid-template-columns: 1fr 1fr 1fr;
                gap: 2px;

            }

            .investiment_characteristics .rate div
            {
                font-size: 10px;
                display: flex;
                text-align: center;
                justify-content: center;
                align-items: center;
                flex-direction: column;
            }




            /*END THIRD PANEL PART */







    </style>


</head>

<body>
    
    <nav>
       Portfolio Trade
    </nav>



    <main>
        <section> 

            <div class="form__group">
                <input type="input" class="form__field" placeholder="Name" name="name" id='name' required />
                <label for="Total_Investment_Value" class="form__label"> Total Investment Value </label>
            </div>

            <div class="inline">

                <div class="form__group tiny">
                    <select name="investment" id="investment-select" class="form__field tiny">
                        <option value="">--Please choose an option--</option>
                        <option value=""></option>
                    </select>
                    <label for="Total_Investment_Value" class="form__label"> Investment type </label>
                </div>
                
            
                <div class="form__group tiny">
                    <input type="input" class="form__field" placeholder="Name" name="name" id='name' required />
                    <label for="Total_Investment_Value" class="form__label"> Value or Percent (Digit with % for that) </label>
                </div>

            </div>

            <div class="inline last">

                <button>
                     Add Investment
                </button>

            </div>



           
        </section>

                

        <section>

                <div class="calendar_container">
                    <label for="selectDay" class="selectDay_label"> Select one day </label>
                    <button id="calendarSwitch" > Select date </button>
                    <!--button to show/hide calendar -->
                    <div class="calendar">
                        <div class="calendar-header">
                            <button id="prev-month">‹</button>
                            <div id="month-year"></div>
                            <button id="next-month">›</button>
                        </div>
                        <div class="calendar-body">
                            <div class="calendar-weekdays">
                                <div>Sun</div>
                                <div>Mon</div>
                                <div>Tue</div>
                                <div>Wed</div>
                                <div>Thu</div>
                                <div>Fri</div>
                                <div>Sat</div>
                            </div>

                            <div class="calendar-dates">
                                <!-- Dates will be populated here -->
                            </div>
                        </div>
                    </div>
        
                </div>
        
                
                
                <div class="all_pizza_container">
                

                    <div class="pizza_container">
                        <label for="selectDay" class="selectDay_label"> Present Day </label>                
                        
                        <canvas class="pizzaChart" id="chart1"></canvas>

                    </div>

                    <div class="pizza_container"> 
                            <label for="selectDay" class="kindChart"> Average </label>                
                    </div>

                    <div class="pizza_container">
                            <label for="selectDay" class="kindChart">  Pessimistic </label>                
                    </div>

                    <div class="pizza_container">

                        <label for="selectDay" class="kindChart"> Optimistic </label>                

                        <canvas class="pizzaChart" id="chart2"></canvas>



                    </div>

                        
                    
                </div>
        </section>
        
        
        
        
        
        <section id="thirdPanel">


            

            <div class="center">
                Projection: Average
            </div>

            <div class="investiment">

                <div class="investiment_characteristics title">
                   Title
                </div>

                <div class="investiment_characteristics">
                    <span> Description: </span>
                    <p> aaaaaa  </p>
                </div>

                <div class="investiment_characteristics">
                    <span> Rate of rendiment vs invested value: </span>
                    <p> aaaaaa  </p>
                </div>

                <div class="investiment_characteristics">
                    <span> Rate of rendiment vs all initial value: </span>
                    <p> aaaaaa  </p>
                </div>


                <div class="investiment_characteristics">
                    <span> Rate (mounth) for forecast type: </span>
                    
                    <div class="rate">
                    
                        <div>
                            <span> Average </span>
                            <p> 2.3 %  </p>
                        </div>
                        <div>
                            <span> Pessimistic </span>
                            <p> 1.0% </p>
                        </div>
                        <div></div>
                    </div>
                </div>






            </div>

        
        
        
        
        </section>
    </main>

</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.5.0/chart.umd.js" integrity="sha512-D4pL3vNgjkHR/qq+nZywuS6Hg1gwR+UzrdBW6Yg8l26revKyQHMgPq9CLJ2+HHalepS+NuGw1ayCCsGXu9JCXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.5.0/chart.umd.min.js" integrity="sha512-Y51n9mtKTVBh3Jbx5pZSJNDDMyY+yGe77DGtBPzRlgsf/YLCh13kSZ3JmfHGzYFCmOndraf0sQgfM654b7dJ3w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


  <script>
    const calendarDates = document.querySelector('.calendar-dates');
    const monthYear = document.getElementById('month-year');
    const prevMonthBtn = document.getElementById('prev-month');
    const nextMonthBtn = document.getElementById('next-month');
    const calendarSwitch = document.getElementById('calendarSwitch');
    const calendar = document.querySelector('.calendar');



    //GET COLORS FROM CSS


    // 1. Get the element where the variable is declared (often :root or document.documentElement)
    const root = document.documentElement;

    // 2. Get the computed style of that element
    const computedStyles = getComputedStyle(root);

    // 3. Retrieve the value of the CSS variable
    const purple = computedStyles.getPropertyValue('--purple').trim();
    const purpleShine = computedStyles.getPropertyValue('--purpleShine').trim();
    const purpleDark = computedStyles.getPropertyValue('--purpleDark').trim();
    const blueDark = computedStyles.getPropertyValue('--blueDark').trim();
    const blueDarker = computedStyles.getPropertyValue('--blueDarker').trim();
    const skintone = computedStyles.getPropertyValue('--skintone').trim();
    const skintoneDark = computedStyles.getPropertyValue('--skintoneDark').trim();
    const backgroundColor = computedStyles.getPropertyValue('--backgroundColor').trim();
    const backgroundAccent = computedStyles.getPropertyValue('--backgroundAccent').trim();
    const backgroundDarker = computedStyles.getPropertyValue('--backgroundDarker').trim();


   /*FUNCTIONS TO TREAT DATES */


        function isDateGapNegative(date1, date2) {
        // Comparing the time values (milliseconds since epoch)
        return date2.getTime() < date1.getTime();
        }


        function getGapDays(date1, date2) {
        // Set both dates to noon to avoid issues with daylight saving time transitions
        const utcDate1 = Date.UTC(date1.getFullYear(), date1.getMonth(), date1.getDate());
        const utcDate2 = Date.UTC(date2.getFullYear(), date2.getMonth(), date2.getDate());

        // The number of milliseconds in one day
        const ONE_DAY_MS = 1000 * 60 * 60 * 24;

        // Calculate the difference in milliseconds and convert to days
        // Use Math.floor() to get whole days and handle partial days consistently
        return Math.floor(Math.abs(utcDate2 - utcDate1) / ONE_DAY_MS);
        }




   /*END OF FUNCTIONS TO TREAT DATES */





    document.addEventListener('DOMContentLoaded', function() {
            // CLose calendar when click out calendar
        document.addEventListener('click', (event) => {

            const isClickInside = calendar.contains(event.target) || calendarSwitch.contains(event.target);
            
            // The click was OUTSIDE the calendar and button
            if(!isClickInside)
                calendar.classList.remove('show');

                
            
        });

    })



    let currentDate = new Date();
    let currentMonth = currentDate.getMonth();
    let currentYear = currentDate.getFullYear();

    const months = [
    'January', 'February', 'March', 'April', 'May', 'June',
    'July', 'August', 'September', 'October', 'November', 'December'
    ];

    function renderCalendar(month, year) {
        
        
        
        
        
        calendarDates.innerHTML = '';
        monthYear.textContent = `${months[month]} ${year}`;

        // Get the first day of the month
        const firstDay = new Date(year, month, 1).getDay();

        // Get the number of days in the month
        const daysInMonth = new Date(year, month + 1, 0).getDate();

  // Create blanks for days of the week before the first day
  for (let i = 0; i < firstDay; i++) {
    const blank = document.createElement('div');
    calendarDates.appendChild(blank);
  }

  // Populate the days
  for (let i = 1; i <= daysInMonth; i++) {
    const day = document.createElement('div');
    day.textContent = i;
    calendarDates.appendChild(day);
  }


 //take each div day and colect its date when click
  var days = document.querySelectorAll('.calendar-dates div');

    

    days.forEach(div => {

        let presentDay = div.innerHTML;
        let presentdivDate = new Date(currentYear, currentMonth, presentDay);

        if(isDateGapNegative(currentDate, presentdivDate))
        {   
            div.classList.add('unable');
            div.title = 'Invalid date: The selected day already gone!'

        }


        
        div.addEventListener('click', () => { 

            let presentDay = div.innerHTML;
            let clickedDate = new Date(currentYear, currentMonth, presentDay);

            if(isDateGapNegative(currentDate, clickedDate))
                return;
            
            
                // Exibindo a data clicada
            console.log(clickedDate);
            days.forEach( div => div.classList.remove('selectDay'))

            div.classList.add('selectDay');

            //select the correct label and show the selected date
            div.closest('.calendar_container').querySelector('.selectDay_label').innerHTML = `Selected data: ${currentMonth + 1}/${presentDay}/${currentYear}, Interval in days: ${getGapDays(currentDate, clickedDate)} `

            calendar.classList.remove('show')
            

        });
    });
}




renderCalendar(currentMonth, currentYear);


document.addEventListener('DOMContentLoaded', function() {
    // Todo o seu código que interage com o DOM deve estar aqui
    
});

//switch to show/hide calendar
var calendarSwitchindex = 0;

calendarSwitch.addEventListener('click', () => {

    calendarSwitchindex ++;

    calendar.classList.toggle('show', calendarSwitchindex % 2 !== 0);


})

prevMonthBtn.addEventListener('click', () => {
  currentMonth--;
  if (currentMonth < 0) {
    currentMonth = 11;
    currentYear--;
  }
  renderCalendar(currentMonth, currentYear);
});

nextMonthBtn.addEventListener('click', () => {
  currentMonth++;
  if (currentMonth > 11) {
    currentMonth = 0;
    currentYear++;
  }
  renderCalendar(currentMonth, currentYear);
});


//Data for Test in chart



var data = {
    // 1. Array de Rótulos (Labels)
    labels: [
        "Red",
        "Green",
        "Yellow"
    ],
    // 2. Conjunto de Dados (Datasets)
    datasets: [{
        // Dados de valor (os números)
        data: [300, 50, 100], 
        
        // Cores de fundo (uma para cada fatia)
        backgroundColor: [
            purple,
            blueDark,
            backgroundColor
        ],
        
        // Cores de destaque (ao passar o mouse)
        hoverBackgroundColor: [
            purpleDark,
            blueDarker,
            backgroundDarker
        ]
    }]
};



var ctx = document.getElementById("chart1").getContext("2d");
new Chart(ctx, {
    type: 'pie', 
    data: data
});


var ctx = document.getElementById("chart2").getContext("2d");
new Chart(ctx, {
    type: 'pie', 
    data: data
});

  </script>



</html>